---
name: Run Azure Login with OpenID Connect and PowerShell
on: [push]

permissions:
  id-token: write
  contents: read

jobs:
  Windows-latest:
    runs-on: ubuntu-latest
    steps:
      - name: OIDC Login to Azure Public Cloud with AzPowershell (enableAzPSSession true)
        uses: azure/login@v1
        with:
          client-id: e8d4449c-e261-4706-a26e-08863e625644  #${{ secrets.AZURE_CLIENT_ID }}
          tenant-id: ab6173ce-1be7-4250-91e6-a35b234162a8 #${{ secrets.AZURE_TENANT_ID }}
          subscription-id: 80752874-f329-4f0f-a5c1-5ef5683d6a42 #${{ secrets.AZURE_SUBSCRIPTION_ID }}
          enable-AzPSSession: true

#      - name: 'Get resource group with PowerShell action'
#        uses: azure/powershell@v1
#        with:
#          inlineScript: |
#            Get-AzResourceGroup
#          azPSVersion: "latest"

      - name: 'Run Azure CLI commands'
        run: |
#          az account show
#          az group list
          pwd